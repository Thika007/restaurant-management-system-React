<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inventory Management</title>
    <link href="../css/style.css" rel="stylesheet" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <div class="main-container">
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg navbar-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    Restaurant Management System
                </a>
                <div class="navbar-nav ms-auto">
                    <button id="notifBell" class="btn btn-link position-relative me-3" onclick="toggleNotifications()">
                        <i class="fas fa-bell"></i>
                        <span id="notifBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="display:none;">0</span>
                    </button>
                    <div class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" data-bs-toggle="dropdown">
                            <i class="fas fa-user me-1"></i> <span id="userRole">User</span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" onclick="showSettings()"><i class="fas fa-cog me-2"></i>Settings</a></li>
                            <li><a class="dropdown-item admin-only" href="#" onclick="clearAllData()"><i class="fas fa-trash-alt me-2"></i>Clear Data</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>

        <div class="content-wrapper">
            <!-- Sidebar -->
            <nav class="sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="dashboard.html">
                                <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="inventory.html">
                                <i class="fas fa-boxes me-2"></i>Master Creation
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="add-stock.html">
                                <i class="fas fa-plus-circle me-2"></i>Add Item Stock
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="internal-transfer.html">
                                <i class="fas fa-exchange-alt me-2"></i>Internal Transfer
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="add-return.html">
                                <i class="fas fa-undo me-2"></i>Add Return Stock
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cash-management.html">
                                <i class="fas fa-money-bill-wave me-2"></i>Cash Management
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="reports.html">
                                <i class="fas fa-chart-bar me-2"></i>Reports
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="expire-tracking.html">
                                <i class="fas fa-clock me-2"></i>Expire Tracking
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="branch-management.html">
                                <i class="fas fa-store me-2"></i>Branch Management
                            </a>
                        </li>
                        <li class="nav-item admin-only">
                            <a class="nav-link" href="user-management.html">
                                <i class="fas fa-users me-2"></i>User Management
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

        <!-- Main Content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 main-content">
          <h2 class="mt-4">Master Creation</h2>

          <!-- Filters Section -->
          <div class="filter-section card mb-3">
            <div class="card-body">
              <h4>Filter Items</h4>
              <div class="row g-3">
                <div class="col-md-3">
                  <select id="filterType" class="form-select">
                    <option value="">All Types</option>
                    <option value="Normal Item">Normal Item</option>
                    <option value="Grocery Item">Grocery Item</option>
                    <option value="Machine">Machine</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <select id="filterCategory" class="form-select">
                    <option value="">All Categories</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <input
                    type="text"
                    id="searchInput"
                    class="form-control"
                    placeholder="Search by name..."
                  />
                </div>
                <div class="col-md-3">
                  <button class="btn btn-primary w-100" onclick="filterItems()">
                    Filter
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Add Item Button -->
          <button
            class="btn btn-success mb-3"
            data-bs-toggle="modal"
            data-bs-target="#addItemModal"
          >
            <i class="fas fa-plus"></i> Add New Item
          </button>

          <!-- Items Table -->
          <div class="card">
            <div class="card-header">Inventory Items</div>
            <div class="card-body">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <!-- <th>Item Code</th> -->
                    <th>Item Name</th>
                    <th>Type</th>
                    <th>Category</th>
                    <th>Subcategory</th>
                    <th>Price (Rs.)</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="inventoryTableBody"></tbody>
              </table>
            </div>
          </div>
        </main>
      </div>
    </div>
  

    <!-- Add Item Modal -->
    <div class="modal fade" id="addItemModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Add New Item</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="itemType" class="form-label">Item Type</label>
              <select
                id="itemType"
                class="form-select"
                onchange="toggleItemFields()"
              >
                <option value="">Select Item Type</option>
                <option value="Normal Item">Normal Item</option>
                <option value="Grocery Item">Grocery Item</option>
                <option value="Machine">Machine</option>
              </select>
            </div>
            <div id="normalItemFields">
              <div class="mb-3">
                <label for="itemName" class="form-label">Item Name</label>
                <input
                  type="text"
                  id="itemName"
                  class="form-control"
                  placeholder="Enter item name"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="category" class="form-label">Category</label>
                <select id="category" class="form-select">
                  <option value="Food">Food</option>
                  <option value="Beverage">Beverage</option>
                  <option value="Dessert">Dessert</option>
                  <option value="Bread">Bread</option>
                  <option value="Pastry">Pastry</option>
                  <option value="Cake">Cake</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="subcategory" class="form-label">Subcategory</label>
                <input
                  type="text"
                  id="subcategory"
                  class="form-control"
                  placeholder="Enter subcategory"
                />
              </div>
              <div class="mb-3">
                <label for="price" class="form-label">Price (Rs.)</label>
                <input
                  type="number"
                  id="price"
                  class="form-control"
                  placeholder="Enter price"
                  min="0"
                  step="0.01"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="description" class="form-label">Description</label>
                <textarea
                  id="description"
                  class="form-control"
                  placeholder="Enter description"
                ></textarea>
              </div>
            </div>
            <div id="groceryItemFields" style="display: none">
              <div class="mb-3">
                <label for="groceryItemName" class="form-label"
                  >Item Name</label
                >
                <input
                  type="text"
                  id="groceryItemName"
                  class="form-control"
                  placeholder="Enter item name"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="groceryCategory" class="form-label">Category</label>
                <input
                  type="text"
                  id="groceryCategory"
                  class="form-control"
                  placeholder="Enter category (e.g., Beverage, Pastry)"
                />
              </div>
              <div class="mb-3">
                <label for="grocerySubcategory" class="form-label"
                  >Subcategory</label
                >
                <input
                  type="text"
                  id="grocerySubcategory"
                  class="form-control"
                  placeholder="Enter subcategory (e.g., Soft Drink, Croissant)"
                />
              </div>
              <div class="mb-3">
                <label for="groceryPrice" class="form-label">Price (Rs.)</label>
                <input
                  type="number"
                  id="groceryPrice"
                  class="form-control"
                  placeholder="Enter price"
                  min="0"
                  step="0.01"
                  required
                />
              </div>
              <div class="form-check mb-2">
                <input class="form-check-input" type="checkbox" value="" id="grocerySoldByWeight" />
                <label class="form-check-label" for="grocerySoldByWeight">
                  Sold by weight
                </label>
                <div class="form-text">If checked, quantities will accept decimals (e.g., kg).</div>
              </div>
              <div class="form-check mb-2">
                <input class="form-check-input" type="checkbox" value="" id="groceryNotifyExpiry" />
                <label class="form-check-label" for="groceryNotifyExpiry">
                  Notify on expiry
                </label>
                <div class="form-text">If checked, you will receive notifications 2 days before the expiry date.</div>
              </div>
            </div>
            <!-- Update the machine fields in inventory.html -->
            <div id="machineFields" style="display: none">
              <div class="alert alert-info">
                <i class="fas fa-info-circle me-2"></i>
                Create a new coffee machine for tracking sales
              </div>
              <div class="mb-3">
                <label for="machineName" class="form-label"
                  >Machine Name *</label
                >
                <input
                  type="text"
                  id="machineName"
                  class="form-control"
                  placeholder="Enter machine name (e.g., Coffee Machine, Nescafe Machine)"
                  required
                />
                <div class="form-text">Unique name for the machine</div>
              </div>
              <div class="mb-3">
                <label for="machinePrice" class="form-label"
                  >Price per Unit (Rs.) *</label
                >
                <input
                  type="number"
                  id="machinePrice"
                  class="form-control"
                  placeholder="Enter price per coffee"
                  min="1"
                  step="1"
                  required
                />
                <div class="form-text">
                  Price charged for each coffee served
                </div>
              </div>
            </div>
          </div>
          <!-- Make sure your modal footer looks like this -->
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button
              type="button"
              id="addItemButton"
              class="btn btn-primary"
              onclick="addItem()"
            >
              Add Item
            </button>
            <button
              type="button"
              id="createMachineButton"
              class="btn btn-success"
              style="display: none"
              onclick="addMachineItem()"
            >
              <i class="fas fa-plus-circle"></i> Create Machine
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Normal Item Modal -->
    <div class="modal fade" id="editItemModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Normal Item</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="editCode" />
            <div class="mb-3">
              <label for="editName" class="form-label">Item Name</label>
              <input type="text" id="editName" class="form-control" required />
            </div>
            <div class="mb-3">
              <label for="editCategory" class="form-label">Category</label>
              <select id="editCategory" class="form-select">
                <option value="Food">Food</option>
                <option value="Beverage">Beverage</option>
                <option value="Dessert">Dessert</option>
                <option value="Bread">Bread</option>
                <option value="Pastry">Pastry</option>
                <option value="Cake">Cake</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="editSubcategory" class="form-label"
                >Subcategory</label
              >
              <input type="text" id="editSubcategory" class="form-control" />
            </div>
            <div class="mb-3">
              <label for="editPrice" class="form-label">Price (Rs.)</label>
              <input
                type="number"
                id="editPrice"
                class="form-control"
                min="0"
                step="0.01"
                required
              />
            </div>
            <div class="mb-3">
              <label for="editDescription" class="form-label"
                >Description</label
              >
              <textarea id="editDescription" class="form-control"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="updateItem()"
            >
              Update
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Grocery Item Modal -->
    <div
      class="modal fade"
      id="editGroceryModal"
      tabindex="-1"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Edit Grocery Item</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="editGroceryCode" />
            <div class="mb-3">
              <label for="editGroceryName" class="form-label">Item Name</label>
              <input
                type="text"
                id="editGroceryName"
                class="form-control"
                required
              />
            </div>
            <div class="mb-3">
              <label for="editGroceryCategory" class="form-label"
                >Category</label
              >
              <input
                type="text"
                id="editGroceryCategory"
                class="form-control"
                placeholder="Enter category"
              />
            </div>
            <div class="mb-3">
              <label for="editGrocerySubcategory" class="form-label"
                >Subcategory</label
              >
              <input
                type="text"
                id="editGrocerySubcategory"
                class="form-control"
                placeholder="Enter subcategory"
              />
            </div>
            <div class="mb-3">
              <label for="editGroceryPrice" class="form-label"
                >Price (Rs.)</label
              >
              <input
                type="number"
                id="editGroceryPrice"
                class="form-control"
                min="0"
                step="0.01"
                required
              />
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="updateGroceryItem()"
            >
              Update
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="../js/common.js"></script>
    <script src="../js/inventory.js"></script>
    <script src="../js/grocery.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/machine.js"></script>
  </body>
</html>